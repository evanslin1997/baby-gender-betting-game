<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¶å¯¶æ€§åˆ¥çŒœçŒœæ¨‚ - æ¸¬è©¦ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem 2rem;
            text-align: center;
        }
        
        .header h1 {
            color: white;
            font-size: 2rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        
        .status {
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .status.connected {
            background: rgba(76, 175, 80, 0.1);
            color: #4caf50;
            border: 2px solid #4caf50;
        }
        
        .status.disconnected {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            border: 2px solid #f44336;
        }
        
        .form-group {
            margin: 1rem 0;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .game-info {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: left;
            margin-top: 2rem;
        }
        
        .game-info h3 {
            margin-bottom: 1rem;
            color: #667eea;
        }
        
        .game-info ul {
            list-style: none;
            color: #666;
        }
        
        .game-info li {
            margin-bottom: 0.5rem;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .game-info li::before {
            content: 'â€¢';
            color: #667eea;
            font-weight: bold;
            position: absolute;
            left: 0;
        }
    </style>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <div class="header">
        <h1>ğŸ‘¶ å¯¶å¯¶æ€§åˆ¥çŒœçŒœæ¨‚</h1>
    </div>
    
    <div class="container">
        <div class="card">
            <div id="connection-status" class="status disconnected">
                âŒ é€£æ¥ä¸­...
            </div>
            
            <div id="join-form">
                <h2>ğŸ® åŠ å…¥éŠæˆ²</h2>
                <div class="form-group">
                    <label for="playerName">ç©å®¶æš±ç¨±</label>
                    <input id="playerName" type="text" class="input" placeholder="è«‹è¼¸å…¥æ‚¨çš„æš±ç¨±" maxlength="20">
                </div>
                <button id="joinBtn" class="btn" disabled>é€£æ¥ä¸­...</button>
            </div>
            
            <div class="game-info">
                <h3>ğŸ¯ éŠæˆ²è¦å‰‡</h3>
                <ul>
                    <li>çŒœæ¸¬å¯¶å¯¶æ˜¯ç”·ç”Ÿé‚„æ˜¯å¥³ç”Ÿ</li>
                    <li>è‡ªè¨‚ä¸‹æ³¨é‡‘é¡</li>
                    <li>çŒœå°çš„ç©å®¶å¹³åˆ†çŒœéŒ¯ç©å®¶çš„ä¸‹æ³¨é‡‘é¡</li>
                    <li>ç¬¬ä¸€å€‹åŠ å…¥çš„ç©å®¶æˆç‚ºä¸»æŒäºº</li>
                    <li>ä¸»æŒäººè² è²¬é–‹å§‹éŠæˆ²å’Œå®£å¸ƒçµæœ</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ– Socket.io
        console.log('æ­£åœ¨åˆå§‹åŒ– Socket.io...');
        
        const socket = io('http://localhost:3333', {
            transports: ['websocket', 'polling'],
            timeout: 5000,
            forceNew: true
        });
        
        const connectionStatus = document.getElementById('connection-status');
        const joinBtn = document.getElementById('joinBtn');
        const playerNameInput = document.getElementById('playerName');
        
        socket.on('connect', () => {
            console.log('âœ… é€£æ¥æˆåŠŸï¼ŒSocket ID:', socket.id);
            connectionStatus.className = 'status connected';
            connectionStatus.textContent = 'âœ… å·²é€£ç·š';
            joinBtn.disabled = false;
            joinBtn.textContent = 'åŠ å…¥éŠæˆ²';
        });
        
        socket.on('disconnect', (reason) => {
            console.log('âŒ é€£æ¥æ–·é–‹ï¼ŒåŸå› :', reason);
            connectionStatus.className = 'status disconnected';
            connectionStatus.textContent = 'âŒ é€£ç·šæ–·é–‹';
            joinBtn.disabled = true;
            joinBtn.textContent = 'é‡æ–°é€£æ¥ä¸­...';
        });
        
        socket.on('connect_error', (error) => {
            console.error('âŒ é€£æ¥éŒ¯èª¤:', error);
            connectionStatus.className = 'status disconnected';
            connectionStatus.textContent = 'âŒ é€£æ¥å¤±æ•—: ' + error.message;
            joinBtn.disabled = true;
            joinBtn.textContent = 'é€£æ¥å¤±æ•—';
        });
        
        socket.on('connected', (data) => {
            console.log('ğŸ”— æœå‹™å™¨é€£æ¥ç¢ºèª:', data);
        });

        socket.on('game-state', (state) => {
            console.log('ğŸ® éŠæˆ²ç‹€æ…‹:', state);
            // éš±è—åŠ å…¥è¡¨å–®ï¼Œé¡¯ç¤ºéŠæˆ²ç•Œé¢
            document.getElementById('join-form').innerHTML = `
                <h2>ğŸ‰ æˆåŠŸåŠ å…¥éŠæˆ²ï¼</h2>
                <div style="background: rgba(76, 175, 80, 0.1); padding: 1rem; border-radius: 10px; margin: 1rem 0;">
                    <p><strong>ç©å®¶:</strong> ${state.currentPlayer.name}</p>
                    <p><strong>èº«ä»½:</strong> ${state.currentPlayer.isHost ? 'ğŸª ä¸»æŒäºº' : 'ğŸ® ç©å®¶'}</p>
                    <p><strong>ç¸½äººæ•¸:</strong> ${state.totalPlayers}</p>
                    <p><strong>éŠæˆ²ç‹€æ…‹:</strong> ${state.status === 'waiting' ? 'ç­‰å¾…é–‹å§‹' : state.status === 'betting' ? 'æŠ•æ³¨ä¸­' : 'å·²çµæŸ'}</p>
                </div>
                ${state.currentPlayer.isHost && state.status === 'waiting' ? 
                    '<button onclick="startBetting()" class="btn" style="margin-top: 1rem;">é–‹å§‹æŠ•æ³¨</button>' : 
                    state.status === 'waiting' ? '<p>ç­‰å¾…ä¸»æŒäººé–‹å§‹éŠæˆ²...</p>' : ''
                }
                <div id="game-area"></div>
            `;
        });
        
        socket.on('join-success', (data) => {
            console.log('âœ… åŠ å…¥æˆåŠŸ:', data);
        });
        
        socket.on('player-joined', (data) => {
            console.log('ğŸ‘¤ æ–°ç©å®¶åŠ å…¥:', data);
            alert('ğŸ‰ æ–°ç©å®¶åŠ å…¥ï¼š' + data.player.name + '\nç•¶å‰ç¸½äººæ•¸ï¼š' + data.totalPlayers);
        });

        socket.on('error', (error) => {
            console.error('âŒ éŒ¯èª¤:', error);
            alert('éŒ¯èª¤: ' + error.message);
        });

        function startBetting() {
            console.log('ğŸ² ç™¼é€é–‹å§‹æŠ•æ³¨è«‹æ±‚');
            socket.emit('start-betting');
        }
        
        joinBtn.addEventListener('click', () => {
            const name = playerNameInput.value.trim();
            if (name) {
                console.log('ğŸ® ç™¼é€åŠ å…¥éŠæˆ²è«‹æ±‚:', name);
                socket.emit('join-game', name);
            } else {
                alert('è«‹è¼¸å…¥æš±ç¨±');
            }
        });
        
        playerNameInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                joinBtn.click();
            }
        });
        
        // é€£æ¥ç‹€æ…‹ç›£æ§
        setTimeout(() => {
            if (!socket.connected) {
                console.log('âš ï¸ 5ç§’å¾Œä»æœªé€£æ¥ï¼Œè«‹æª¢æŸ¥æœå‹™å™¨ç‹€æ…‹');
                connectionStatus.textContent = 'âš ï¸ é€£æ¥è¶…æ™‚ï¼Œè«‹åˆ·æ–°é é¢é‡è©¦';
            }
        }, 5000);
    </script>
</body>
</html>